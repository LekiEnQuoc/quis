-- üîπ Auto Spawn + Auto Farm Script Ho√†n Ch·ªânh (Fix: sau khi ch·∫øt v·∫´n u·ªëng n∆∞·ªõc)

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer
local SpawnEvent = ReplicatedStorage:WaitForChild("Connections"):WaitForChild("Spawn")

-- Danh s√°ch juice
local drinkList = {
    "Sour Juice",
    "Fruit Juice",
    "Pumpkin Juice",
    "Banana Juice",
    "Apple Juice",
    "Pear Juice",
    "Coconut Milk",
}

-- l·∫•y backpack m·ªõi nh·∫•t
local function getBackpack()
    return player:WaitForChild("Backpack")
end

-- üîπ H√†m spawn
local function spawnChar()
    print("‚ñ∂ Auto Spawn...")
    SpawnEvent:FireServer(10)
end

-- üîπ H√†m u·ªëng n∆∞·ªõc
local function Uongnuoc()
    local backpack = getBackpack()
    for _, item in ipairs(backpack:GetChildren()) do
        if table.find(drinkList, item.Name) and item:IsA("Tool") then
            item.Parent = player.Character
            task.wait(0.2)
            if player.Character:FindFirstChild(item.Name) then
                print("ü•§ U·ªëng:", item.Name)
                item:Activate()
                task.wait(0.5)
            end
        end
    end
end

-- üîπ H√†m teleport + click
local function TeleportAndClick(x, y, z, radius)
    local char = player.Character or player.CharacterAdded:Wait()
    local hrp = char:WaitForChild("HumanoidRootPart")

    hrp.CFrame = CFrame.new(x, y, z)
    task.wait(0.05)

    local RADIUS = radius or 10
    for _, v in pairs(workspace:GetDescendants()) do
        if v:IsA("ClickDetector") then
            local parentPart = v.Parent
            if parentPart and parentPart:IsA("BasePart") then
                if not (parentPart:IsDescendantOf(workspace.Merchants.QuestFishMerchant)
                    or parentPart:IsDescendantOf(workspace.Merchants.FishMerchant)) then

                    local distance = (hrp.Position - parentPart.Position).Magnitude
                    if distance <= RADIUS then
                        fireclickdetector(v, 1)
                    end
                end
            end
        end
    end
end

-- üîπ Danh s√°ch ƒëi·ªÉm teleport
local teleportPoints = {
    {-1492.856812, 216.999985, -304.369904, 7},
    {-1509.853760, 216.999985, -288.241730},
    {-1547.135376, 216.999985, -305.709229},
    {-204.250305, 224.499985, -205.790115, 6},
    {-10.922343, 215.999985, -355.356842, 6},
    {-0.771519, 215.999985, -379.533539},
    {1174.637085, 216.999985, -286.647034},
    {1179.688110, 216.999985, -280.636566, 15},
    {1987.863281, 217.999985, 562.384155},
    {-1708.811890, 215.999985, -325.484009},
    {1012.40, 217.00, 3341.04},
    {893.09, 216.00, 3391.85, 30},
    {1166.29, 216.00, 3224.77},
    {-2611.89, 253.70, 1109.05, 20},
    {986.47, 224.00, -3334.53},
    {1979.76, 217.00, 554.20},
    {1992.30, 234.00, 571.38},
    {1968.65, 218.00, 576.20},
    {-1752.73, 216.00, -215.40},
    {-1753.26, 217.22, -327.55},
}

-- üîπ H√†m farm
local function StartFarm()
    local char = player.Character or player.CharacterAdded:Wait()
    char:WaitForChild("HumanoidRootPart")
    print("‚úÖ B·∫Øt ƒë·∫ßu farm...")

    while char.Parent and char:FindFirstChild("Humanoid") and char.Humanoid.Health > 0 do
        for _, point in ipairs(teleportPoints) do
            TeleportAndClick(table.unpack(point))
            task.wait(0.1)
        end
        Uongnuoc()
        task.wait(1)
    end
end

-- üîπ Khi ch·∫øt th√¨ spawn l·∫°i
player.CharacterRemoving:Connect(function()
    print("‚ö∞ Nh√¢n v·∫≠t ch·∫øt, ch·ªù spawn...")
    task.wait(3)
    spawnChar()
end)

-- üîπ Khi spawn th√¨ farm
player.CharacterAdded:Connect(function(char)
    task.spawn(function()
        char:WaitForChild("HumanoidRootPart")
        task.wait(1)
        StartFarm()
    end)
end)

-- üîπ N·∫øu ƒëang s·ªëng th√¨ farm lu√¥n
if player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
    task.spawn(StartFarm)
else
    spawnChar()
end

-- üîπ Anti-AFK
local vu = game:GetService("VirtualUser")
Players.LocalPlayer.Idled:Connect(function()
    vu:Button2Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    task.wait(1)
    vu:Button2Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    print("üõ° Anti-AFK: ƒê√£ ch·∫∑n kick")
end)

